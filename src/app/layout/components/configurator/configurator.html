<button *ngIf="simple()" class="layout-config-button config-link" type="button" (click)="toggleConfigSidebar()">
    <i class="pi pi-cog"></i>
</button>
<p-drawer [(visible)]="configSidebarVisible" position="right" [transitionOptions]="'.3s cubic-bezier(0, 0, 0.2, 1)'" styleClass="layout-config-sidebar w-80" header="Configuración">
    <div class="flex flex-col gap-4">

        <!-- Primary colors — comentado temporalmente hasta que el backend esté listo -->
        <!--
        <div>
            <span class="text-lg font-semibold">Color primario</span>
            <div class="pt-2 flex gap-2 flex-wrap">
                @for (primaryColor of primaryColors(); track primaryColor.name) {
                <button
                    type="button"
                    [title]="primaryColor.name"
                    (click)="updateColors($event, 'primary', primaryColor)"
                    [ngClass]="{
                                    'outline outline-primary': primaryColor.name === selectedPrimaryColor()
                                }"
                    class="cursor-pointer w-6 h-6 rounded-full flex shrink-0 items-center justify-center outline-offset-1 shadow"
                    [style]="{
                                    'background-color': primaryColor?.name === 'noir' ? 'var(--text-color)' : primaryColor?.palette?.['500']
                                }"
                ></button>
                }
            </div>
        </div>
        -->

        @if (saving()) {
            <!-- Skeleton mientras guarda -->
            <div class="flex flex-col gap-4">
                <div>
                    <p-skeleton width="6rem" height="1.25rem" styleClass="mb-2"></p-skeleton>
                    <div class="flex gap-2 flex-wrap pt-1">
                        @for (i of [1,2,3,4,5,6,7,8]; track i) {
                            <p-skeleton shape="circle" size="1.5rem"></p-skeleton>
                        }
                    </div>
                </div>
                <div>
                    <p-skeleton width="7rem" height="1.25rem" styleClass="mb-2"></p-skeleton>
                    <p-skeleton width="100%" height="2rem"></p-skeleton>
                </div>
                <div>
                    <p-skeleton width="8rem" height="1.25rem" styleClass="mb-2"></p-skeleton>
                    <p-skeleton width="100%" height="2rem"></p-skeleton>
                </div>
                @if (!simple()) {
                    <div>
                        <p-skeleton width="7rem" height="1.25rem" styleClass="mb-2"></p-skeleton>
                        <div class="flex flex-col gap-2">
                            <p-skeleton width="100%" height="1.5rem"></p-skeleton>
                            <p-skeleton width="100%" height="1.5rem"></p-skeleton>
                        </div>
                    </div>
                    <div>
                        <p-skeleton width="9rem" height="1.25rem" styleClass="mb-2"></p-skeleton>
                        <div class="flex flex-col gap-2">
                            <p-skeleton width="100%" height="1.5rem"></p-skeleton>
                            <p-skeleton width="100%" height="1.5rem"></p-skeleton>
                        </div>
                    </div>
                }
                <p-skeleton width="100%" height="2.5rem"></p-skeleton>
            </div>
        } @else {

        <div>
            <span class="text-lg font-semibold">Superficie</span>
            <div class="pt-2 flex gap-2 flex-wrap">
                @for (surface of surfaces; track surface.name) {
                <button
                    type="button"
                    [title]="surface.name"
                    (click)="updateColors($event, 'surface', surface)"
                    class="cursor-pointer w-6 h-6 rounded-full flex shrink-0 items-center justify-center p-0 outline-offset-1"
                    [ngClass]="{
                                    'outline outline-primary': selectedSurface() ? selectedSurface() === surface.name : darkTheme() ? surface.name === 'zinc' : surface.name === 'slate'
                                }"
                    [style]="{
                                    'background-color': surface?.palette?.['500']
                                }"
                ></button>
                }
            </div>
        </div>

        <div class="flex flex-col gap-2">
            <span class="text-lg font-semibold">Tema visual</span>
            <p-selectbutton [options]="presetOptions" [ngModel]="selectedPreset()" (ngModelChange)="onPresetChange($event)" [allowEmpty]="false" size="small"></p-selectbutton>
        </div>

        <div class="flex flex-col gap-2">
            <span class="text-lg font-semibold">Modo de color</span>
            <p-selectbutton [ngModel]="darkTheme()" (ngModelChange)="toggleDarkMode()" [options]="themeOptions" optionLabel="name" optionValue="value" [allowEmpty]="false"></p-selectbutton>
        </div>

        @if (!simple()) {
        <div class="flex flex-col gap-2">
            <span class="text-lg font-semibold">Tipo de menú</span>
            <div class="flex flex-wrap flex-col gap-3">
                <div class="flex">
                    <div class="flex items-center gap-2 w-1/2">
                        <p-radio-button name="menuMode" value="static" [(ngModel)]="menuMode"></p-radio-button>
                        <label for="static">Estático</label>
                    </div>

                    <div class="flex items-center gap-2 w-1/2">
                        <p-radio-button name="menuMode" value="overlay" [(ngModel)]="menuMode"></p-radio-button>
                        <label for="overlay">Overlay</label>
                    </div>
                </div>
                <div class="flex">
                    <div class="flex items-center gap-2 w-1/2">
                        <p-radio-button name="menuMode" value="slim" [(ngModel)]="menuMode"></p-radio-button>
                        <label for="slim">Slim</label>
                    </div>
                    <div class="flex items-center gap-2 w-1/2">
                        <p-radio-button name="menuMode" value="slim-plus" [(ngModel)]="menuMode" inputId="slim-plus"></p-radio-button>
                        <label for="slim-plus">Slim+</label>
                    </div>
                </div>
            </div>
        </div>

        <div class="flex flex-col gap-2">
            <span class="text-lg font-semibold">Tema del layout</span>
            <div class="flex flex-col gap-4">
                <div class="flex items-center gap-2">
                    <p-radio-button name="layoutTheme" value="colorScheme" [ngModel]="layoutTheme()" inputId="colorScheme" (ngModelChange)="onLayoutThemeChange('colorScheme')"></p-radio-button>
                    <label for="colorScheme">Esquema de color</label>
                </div>
                <div class="flex items-center gap-2">
                    <p-radio-button name="layoutTheme" value="primaryColor" [ngModel]="layoutTheme()" (ngModelChange)="onLayoutThemeChange('primaryColor')" inputId="primaryColor" [disabled]="layoutService.isDarkTheme()"></p-radio-button>
                    <label for="primaryColor">Color primario (solo modo claro)</label>
                </div>
            </div>
        </div>
        }

        <p-button label="Guardar" icon="pi pi-save" styleClass="w-full" (onClick)="saveConfig()" [loading]="saving()" [disabled]="saving()"></p-button>

        } <!-- end @else -->
    </div>
</p-drawer>
